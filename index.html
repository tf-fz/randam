<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ランダム選曲</title>
<meta name="keywords" content="ランダム選曲">
<meta name="description" content="セガ音ゲーのランダム選曲">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="index.css">

<script>
  window.onload = viewChange;
let select 
let conmax1 
function buttonClick() {
	select = document.querySelector('[name="list"]');
	conmax1 = document.getElementById('conmax');
	document.getElementById(sm[0]).style.display = "none";
        if (document.getElementById('list')){
        id = document.getElementById('list').value;
        if (select.value == 'オンゲキ'){
		game = 'オンゲキ';
		sm.push("f1");
        }else if (select.value == 'チュウニズム'){
		game = 'チュウニズム';
        	sm.push("ub1");
        }else if (select.value == 'maimai'){
		game = 'maimai';
		sm.push("ua1");
        }
		document.write(select);
	document.write(game);
	document.write(conmax1);
	console.log(conmax1);
}
let button = document.getElementById('btn');


function viewChange(){
	document.getElementById(sm[0]).style.display = "none";
        if (document.getElementById('list')){
        id = document.getElementById('list').value;
        sm = [];
        if (select.value == 'オンゲキ'){
		game = 'オンゲキ';
		sm.push("f1");
        }else if (select.value == 'チュウニズム'){
		game = 'チュウニズム';
        	sm.push("ub1");
        }else if (select.value == 'maimai'){
		game = 'maimai';
		sm.push("ua1");
        }

//空の配列を作成	
let game = interaction.options.getString('機種');
		let difmin = interaction.options.getNumber('定数最小値');
		let difmax = interaction.options.getNumber('定数最大値');

let song = []
//別ファイルにある曲名リストをsongに入れる
song = song.concat(g.song)


		//機種の絞り込み
		let data0 = song.filter( p => p.dev == game)
		//定数下限の絞り込み
		let data1 = data0.filter( p => p.con >= difmin)
		//定数上限の絞り込み
		let data = data1.filter( q => q.con <= difmax).map(m => m.曲名)
		let subdata = data1.filter( q => q.con <= difmax).map(m => m.con)
		let maidata = data1.filter( q => q.con <= difmax).map(m => m.type)


		
		let rand = Math.floor( Math.random() * data.length);
		if (game == 'チュウニズム'){
			await interaction.reply(game+"のランダム選曲は準備中です");
		}else if (game == 'maimai'){
			if (difmin == difmax){
				await interaction.reply("機種：" +game +"\n" +"難易度指定：" +difmin.toFixed(1) +"　譜面定数：" +subdata[rand].toFixed(1) +"\n譜面タイプ：" +maidata[rand] +"\n曲名：" +data[rand]);
			}else if (difmin < difmax){
				await interaction.reply("機種：" +game +"\n" +"難易度指定："+difmin.toFixed(1)+"～"+difmax.toFixed(1)+"　譜面定数：" +subdata[rand].toFixed(1) +"\n譜面タイプ：" +maidata[rand] +"\n曲名：" +data[rand]);
			}else if (difmin > difmax){
				await interaction.reply("max"+difmax.toFixed(1)+" , min"+difmin.toFixed(1)+" , お前頭グミ");
		}
		}else if (difmin > difmax){
			await interaction.reply("max"+difmax.toFixed(1)+" , min"+difmin.toFixed(1)+" , お前頭グミ");
		}else if (difmin == difmax){
			await interaction.reply("機種：" +game +"\n" +"難易度指定：" +difmin.toFixed(1) +"　譜面定数：" +subdata[rand].toFixed(1) +"\n曲名：" +data[rand]);
		}else if (difmin < difmax){
			await interaction.reply("機種：" +game +"\n" +"難易度指定："+difmin.toFixed(1)+"～"+difmax.toFixed(1)+"　譜面定数：" +subdata[rand].toFixed(1) +"\n曲名：" +data[rand]);
		}
	},
};
</script>
</head>
  
<body>
<center>
<header><h1>ランダム選曲</h1>
</header>

<main>
  
  <select class= "list" id="list" name="list" onclick="viewChange()"><br>
        <option value="オンゲキ">オンゲキ
        <option value="チュウニズム">チュウニズム
        <option value="maimai">maimai
  </select>
  <p>定数最大値
  <input type="search" name="conmax" id="conmax" required="required" list ="request"/></p>
  <p>定数最小値
  <input type="search" name="conmim" id="conmin" required="required" list ="request"/></p>
      <datalist id="request">
        <option value="0">
        <option value="13.0">
        <option value="13.1">
        <option value="13.2">
        <option value="13.3">
        <option value="13.4">
        <option value="13.5">
        <option value="13.6">
        <option value="13.7">
        <option value="13.8">
        <option value="13.9">
        <option value="14.0">
        <option value="14.1">
        <option value="14.2">
        <option value="14.3">
        <option value="14.4">
        <option value="14.5">
        <option value="14.6">
        <option value="14.7">
        <option value="14.8">
        <option value="14.9">
        <option value="15.0">
        <option value="15.1">
        <option value="15.2">
        <option value="15.3">
        <option value="15.4">
        <option value="15.6">
        <option value="15.7">
      </datalist>
  
  <button type="button" id="btn" onclick="buttonClick()">送信する</button>

</main>
</center>

</body>
</html>
